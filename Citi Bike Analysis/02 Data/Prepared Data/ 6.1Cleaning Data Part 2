{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "bbf33810",
   "metadata": {},
   "source": [
    "# Import Libraries"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "99ce9682",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as no\n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "052e73b3",
   "metadata": {},
   "outputs": [],
   "source": [
    "path = r\"C:\\Users\\justi\\Citi Bike Analysis\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "047c3d24",
   "metadata": {},
   "outputs": [],
   "source": [
    "citibike_df = pd.read_csv(r\"C:\\Users\\justi\\OneDrive\\Documents\\Data Sourcing\\archive\\citibike.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4d6d95ba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>trip_id</th>\n",
       "      <th>bike_id</th>\n",
       "      <th>weekday</th>\n",
       "      <th>start_hour</th>\n",
       "      <th>start_time</th>\n",
       "      <th>start_station_id</th>\n",
       "      <th>start_station_name</th>\n",
       "      <th>start_station_latitude</th>\n",
       "      <th>start_station_longitude</th>\n",
       "      <th>end_time</th>\n",
       "      <th>end_station_id</th>\n",
       "      <th>end_station_name</th>\n",
       "      <th>end_station_latitude</th>\n",
       "      <th>end_station_longitude</th>\n",
       "      <th>trip_duration</th>\n",
       "      <th>subscriber</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>gender</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>LnQzQk</td>\n",
       "      <td>16013</td>\n",
       "      <td>Mon</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-09-09 18:18:55</td>\n",
       "      <td>523</td>\n",
       "      <td>W 38 St &amp; 8 Ave</td>\n",
       "      <td>40.754666</td>\n",
       "      <td>-73.991382</td>\n",
       "      <td>2013-09-09 18:35:28</td>\n",
       "      <td>334</td>\n",
       "      <td>W 20 St &amp; 7 Ave</td>\n",
       "      <td>40.742388</td>\n",
       "      <td>-73.997262</td>\n",
       "      <td>993</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1968.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>IL9boN</td>\n",
       "      <td>15230</td>\n",
       "      <td>Thu</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-09-12 18:38:53</td>\n",
       "      <td>257</td>\n",
       "      <td>Lispenard St &amp; Broadway</td>\n",
       "      <td>40.719392</td>\n",
       "      <td>-74.002472</td>\n",
       "      <td>2013-09-12 18:48:34</td>\n",
       "      <td>236</td>\n",
       "      <td>St Marks Pl &amp; 2 Ave</td>\n",
       "      <td>40.728419</td>\n",
       "      <td>-73.987140</td>\n",
       "      <td>581</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1983.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>46clGB</td>\n",
       "      <td>17942</td>\n",
       "      <td>Wed</td>\n",
       "      <td>19</td>\n",
       "      <td>2013-09-18 19:44:04</td>\n",
       "      <td>479</td>\n",
       "      <td>9 Ave &amp; W 45 St</td>\n",
       "      <td>40.760193</td>\n",
       "      <td>-73.991255</td>\n",
       "      <td>2013-09-18 19:50:05</td>\n",
       "      <td>513</td>\n",
       "      <td>W 56 St &amp; 10 Ave</td>\n",
       "      <td>40.768254</td>\n",
       "      <td>-73.988639</td>\n",
       "      <td>361</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1989.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>v7vdFt</td>\n",
       "      <td>19683</td>\n",
       "      <td>Sat</td>\n",
       "      <td>11</td>\n",
       "      <td>2013-09-28 11:54:37</td>\n",
       "      <td>527</td>\n",
       "      <td>E 33 St &amp; 1 Ave</td>\n",
       "      <td>40.743156</td>\n",
       "      <td>-73.974347</td>\n",
       "      <td>2013-09-28 12:03:58</td>\n",
       "      <td>441</td>\n",
       "      <td>E 52 St &amp; 2 Ave</td>\n",
       "      <td>40.756014</td>\n",
       "      <td>-73.967416</td>\n",
       "      <td>561</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1988.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>VGBsb5</td>\n",
       "      <td>18024</td>\n",
       "      <td>Sat</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-09-07 18:08:22</td>\n",
       "      <td>521</td>\n",
       "      <td>8 Ave &amp; W 31 St</td>\n",
       "      <td>40.750450</td>\n",
       "      <td>-73.994811</td>\n",
       "      <td>2013-09-07 18:46:38</td>\n",
       "      <td>476</td>\n",
       "      <td>E 31 St &amp; 3 Ave</td>\n",
       "      <td>40.743943</td>\n",
       "      <td>-73.979661</td>\n",
       "      <td>2296</td>\n",
       "      <td>Non-Subscriber</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>HbKJBz</td>\n",
       "      <td>14581</td>\n",
       "      <td>Fri</td>\n",
       "      <td>22</td>\n",
       "      <td>2013-09-27 22:01:01</td>\n",
       "      <td>293</td>\n",
       "      <td>Lafayette St &amp; E 8 St</td>\n",
       "      <td>40.730287</td>\n",
       "      <td>-73.990765</td>\n",
       "      <td>2013-09-27 22:08:08</td>\n",
       "      <td>432</td>\n",
       "      <td>E 7 St &amp; Avenue A</td>\n",
       "      <td>40.726218</td>\n",
       "      <td>-73.983799</td>\n",
       "      <td>427</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>aOKk3s</td>\n",
       "      <td>15022</td>\n",
       "      <td>Sun</td>\n",
       "      <td>13</td>\n",
       "      <td>2013-09-29 13:13:06</td>\n",
       "      <td>380</td>\n",
       "      <td>W 4 St &amp; 7 Ave S</td>\n",
       "      <td>40.734011</td>\n",
       "      <td>-74.002939</td>\n",
       "      <td>2013-09-29 13:23:45</td>\n",
       "      <td>317</td>\n",
       "      <td>E 6 St &amp; Avenue B</td>\n",
       "      <td>40.724537</td>\n",
       "      <td>-73.981854</td>\n",
       "      <td>639</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1994.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>kpcluW</td>\n",
       "      <td>16253</td>\n",
       "      <td>Sat</td>\n",
       "      <td>10</td>\n",
       "      <td>2013-09-21 10:48:14</td>\n",
       "      <td>346</td>\n",
       "      <td>Bank St &amp; Hudson St</td>\n",
       "      <td>40.736529</td>\n",
       "      <td>-74.006180</td>\n",
       "      <td>2013-09-21 10:52:37</td>\n",
       "      <td>212</td>\n",
       "      <td>W 16 St &amp; The High Line</td>\n",
       "      <td>40.743349</td>\n",
       "      <td>-74.006818</td>\n",
       "      <td>263</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1969.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>GC8mJC</td>\n",
       "      <td>16745</td>\n",
       "      <td>Fri</td>\n",
       "      <td>12</td>\n",
       "      <td>2013-09-20 12:29:49</td>\n",
       "      <td>510</td>\n",
       "      <td>W 51 St &amp; 6 Ave</td>\n",
       "      <td>40.760660</td>\n",
       "      <td>-73.980420</td>\n",
       "      <td>2013-09-20 12:40:55</td>\n",
       "      <td>422</td>\n",
       "      <td>W 59 St &amp; 10 Ave</td>\n",
       "      <td>40.770513</td>\n",
       "      <td>-73.988038</td>\n",
       "      <td>666</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>qyXq7X</td>\n",
       "      <td>19556</td>\n",
       "      <td>Tue</td>\n",
       "      <td>16</td>\n",
       "      <td>2013-09-03 16:56:06</td>\n",
       "      <td>446</td>\n",
       "      <td>W 24 St &amp; 7 Ave</td>\n",
       "      <td>40.744876</td>\n",
       "      <td>-73.995299</td>\n",
       "      <td>2013-09-03 17:05:48</td>\n",
       "      <td>342</td>\n",
       "      <td>Columbia St &amp; Rivington St</td>\n",
       "      <td>40.717400</td>\n",
       "      <td>-73.980166</td>\n",
       "      <td>582</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1983.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  trip_id  bike_id weekday  start_hour           start_time  start_station_id  \\\n",
       "0  LnQzQk    16013     Mon          18  2013-09-09 18:18:55               523   \n",
       "1  IL9boN    15230     Thu          18  2013-09-12 18:38:53               257   \n",
       "2  46clGB    17942     Wed          19  2013-09-18 19:44:04               479   \n",
       "3  v7vdFt    19683     Sat          11  2013-09-28 11:54:37               527   \n",
       "4  VGBsb5    18024     Sat          18  2013-09-07 18:08:22               521   \n",
       "5  HbKJBz    14581     Fri          22  2013-09-27 22:01:01               293   \n",
       "6  aOKk3s    15022     Sun          13  2013-09-29 13:13:06               380   \n",
       "7  kpcluW    16253     Sat          10  2013-09-21 10:48:14               346   \n",
       "8  GC8mJC    16745     Fri          12  2013-09-20 12:29:49               510   \n",
       "9  qyXq7X    19556     Tue          16  2013-09-03 16:56:06               446   \n",
       "\n",
       "        start_station_name  start_station_latitude  start_station_longitude  \\\n",
       "0          W 38 St & 8 Ave               40.754666               -73.991382   \n",
       "1  Lispenard St & Broadway               40.719392               -74.002472   \n",
       "2          9 Ave & W 45 St               40.760193               -73.991255   \n",
       "3          E 33 St & 1 Ave               40.743156               -73.974347   \n",
       "4          8 Ave & W 31 St               40.750450               -73.994811   \n",
       "5    Lafayette St & E 8 St               40.730287               -73.990765   \n",
       "6         W 4 St & 7 Ave S               40.734011               -74.002939   \n",
       "7      Bank St & Hudson St               40.736529               -74.006180   \n",
       "8          W 51 St & 6 Ave               40.760660               -73.980420   \n",
       "9          W 24 St & 7 Ave               40.744876               -73.995299   \n",
       "\n",
       "              end_time  end_station_id            end_station_name  \\\n",
       "0  2013-09-09 18:35:28             334             W 20 St & 7 Ave   \n",
       "1  2013-09-12 18:48:34             236         St Marks Pl & 2 Ave   \n",
       "2  2013-09-18 19:50:05             513            W 56 St & 10 Ave   \n",
       "3  2013-09-28 12:03:58             441             E 52 St & 2 Ave   \n",
       "4  2013-09-07 18:46:38             476             E 31 St & 3 Ave   \n",
       "5  2013-09-27 22:08:08             432           E 7 St & Avenue A   \n",
       "6  2013-09-29 13:23:45             317           E 6 St & Avenue B   \n",
       "7  2013-09-21 10:52:37             212     W 16 St & The High Line   \n",
       "8  2013-09-20 12:40:55             422            W 59 St & 10 Ave   \n",
       "9  2013-09-03 17:05:48             342  Columbia St & Rivington St   \n",
       "\n",
       "   end_station_latitude  end_station_longitude  trip_duration      subscriber  \\\n",
       "0             40.742388             -73.997262            993      Subscriber   \n",
       "1             40.728419             -73.987140            581      Subscriber   \n",
       "2             40.768254             -73.988639            361      Subscriber   \n",
       "3             40.756014             -73.967416            561      Subscriber   \n",
       "4             40.743943             -73.979661           2296  Non-Subscriber   \n",
       "5             40.726218             -73.983799            427      Subscriber   \n",
       "6             40.724537             -73.981854            639      Subscriber   \n",
       "7             40.743349             -74.006818            263      Subscriber   \n",
       "8             40.770513             -73.988038            666      Subscriber   \n",
       "9             40.717400             -73.980166            582      Subscriber   \n",
       "\n",
       "   birth_year  gender  \n",
       "0      1968.0       2  \n",
       "1      1983.0       1  \n",
       "2      1989.0       1  \n",
       "3      1988.0       2  \n",
       "4         NaN       0  \n",
       "5      1986.0       2  \n",
       "6      1994.0       1  \n",
       "7      1969.0       1  \n",
       "8      1993.0       1  \n",
       "9      1983.0       1  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citibike_df.head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "86dc085d",
   "metadata": {},
   "source": [
    "# Check for missing values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2e103dcd",
   "metadata": {},
   "outputs": [],
   "source": [
    "missing_values = citibike_df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6e46967f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing values in citibike_df:\n"
     ]
    }
   ],
   "source": [
    "print(\"Missing values in citibike_df:\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "4c621d5b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "trip_id                       0\n",
      "bike_id                       0\n",
      "weekday                       0\n",
      "start_hour                    0\n",
      "start_time                    0\n",
      "start_station_id              0\n",
      "start_station_name            0\n",
      "start_station_latitude        0\n",
      "start_station_longitude       0\n",
      "end_time                      0\n",
      "end_station_id                0\n",
      "end_station_name              0\n",
      "end_station_latitude          0\n",
      "end_station_longitude         0\n",
      "trip_duration                 0\n",
      "subscriber                    0\n",
      "birth_year                 6979\n",
      "gender                        0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "print(missing_values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "de8d6281",
   "metadata": {},
   "outputs": [],
   "source": [
    "missing_birth_year = citibike_df[citibike_df['birth_year'].isnull()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "9ddb66d3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Rows with missing values in the 'birth_year' column:\n"
     ]
    }
   ],
   "source": [
    "print(\"Rows with missing values in the 'birth_year' column:\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "704dfdfe",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      trip_id  bike_id weekday  start_hour           start_time  \\\n",
      "4      VGBsb5    18024     Sat          18  2013-09-07 18:08:22   \n",
      "10     aZsCdK    15732     Sat          20  2013-09-07 20:01:58   \n",
      "17     VqhF3S    15651     Mon          18  2013-09-30 18:32:48   \n",
      "26     9yZrq6    17506     Sun          16  2013-09-01 16:18:58   \n",
      "46     t1KBiF    19206     Sun          22  2013-09-01 22:49:52   \n",
      "...       ...      ...     ...         ...                  ...   \n",
      "49986  8wDcq8    19293     Sun          22  2013-09-29 22:00:43   \n",
      "49988  C0ivmQ    18118     Sun          12  2013-09-22 12:19:44   \n",
      "49993  cvgHF4    18458     Wed          19  2013-09-25 19:01:07   \n",
      "49995  Fb2bmC    17988     Sat          18  2013-09-21 18:39:20   \n",
      "49998  xxacSt    16763     Sat          13  2013-09-07 13:25:35   \n",
      "\n",
      "       start_station_id      start_station_name  start_station_latitude  \\\n",
      "4                   521         8 Ave & W 31 St               40.750450   \n",
      "10                  457      Broadway & W 58 St               40.766953   \n",
      "17                  363          West Thames St               40.708347   \n",
      "26                  389     Broadway & Berry St               40.710446   \n",
      "46                  426   West St & Chambers St               40.717548   \n",
      "...                 ...                     ...                     ...   \n",
      "49986               469      Broadway & W 53 St               40.763441   \n",
      "49988               352         W 56 St & 6 Ave               40.763406   \n",
      "49993               284   Greenwich Ave & 8 Ave               40.739017   \n",
      "49995               479         9 Ave & W 45 St               40.760193   \n",
      "49998               271  Ashland Pl & Hanson Pl               40.685282   \n",
      "\n",
      "       start_station_longitude             end_time  end_station_id  \\\n",
      "4                   -73.994811  2013-09-07 18:46:38             476   \n",
      "10                  -73.981693  2013-09-07 20:23:51             512   \n",
      "17                  -74.017134  2013-09-30 19:01:59             514   \n",
      "26                  -73.965251  2013-09-01 16:26:56             389   \n",
      "46                  -74.013221  2013-09-01 23:06:48             247   \n",
      "...                        ...                  ...             ...   \n",
      "49986               -73.982681  2013-09-29 22:17:52             444   \n",
      "49988               -73.977225  2013-09-22 12:29:55             464   \n",
      "49993               -74.002638  2013-09-25 19:19:11             329   \n",
      "49995               -73.991255  2013-09-21 20:08:59             478   \n",
      "49998               -73.978058  2013-09-07 14:14:04             373   \n",
      "\n",
      "                   end_station_name  end_station_latitude  \\\n",
      "4                   E 31 St & 3 Ave             40.743943   \n",
      "10                  W 29 St & 9 Ave             40.750073   \n",
      "17                 12 Ave & W 40 St             40.760875   \n",
      "26              Broadway & Berry St             40.710446   \n",
      "46           Perry St & Bleecker St             40.735354   \n",
      "...                             ...                   ...   \n",
      "49986            Broadway & W 24 St             40.742354   \n",
      "49988               E 56 St & 3 Ave             40.759345   \n",
      "49993     Greenwich St & N Moore St             40.720434   \n",
      "49995              11 Ave & W 41 St             40.760301   \n",
      "49998  Willoughby Ave & Walworth St             40.693317   \n",
      "\n",
      "       end_station_longitude  trip_duration      subscriber  birth_year  \\\n",
      "4                 -73.979661           2296  Non-Subscriber         NaN   \n",
      "10                -73.998393           1313  Non-Subscriber         NaN   \n",
      "17                -74.002777           1751  Non-Subscriber         NaN   \n",
      "26                -73.965251            478  Non-Subscriber         NaN   \n",
      "46                -74.004831           1016  Non-Subscriber         NaN   \n",
      "...                      ...            ...             ...         ...   \n",
      "49986             -73.989151           1029  Non-Subscriber         NaN   \n",
      "49988             -73.967597            611  Non-Subscriber         NaN   \n",
      "49993             -74.010206           1084  Non-Subscriber         NaN   \n",
      "49995             -73.998842           2697  Non-Subscriber         NaN   \n",
      "49998             -73.953820           2697  Non-Subscriber         NaN   \n",
      "\n",
      "       gender  \n",
      "4           0  \n",
      "10          0  \n",
      "17          0  \n",
      "26          0  \n",
      "46          0  \n",
      "...       ...  \n",
      "49986       0  \n",
      "49988       0  \n",
      "49993       0  \n",
      "49995       0  \n",
      "49998       0  \n",
      "\n",
      "[6979 rows x 18 columns]\n"
     ]
    }
   ],
   "source": [
    "print(missing_birth_year)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "31bee664",
   "metadata": {},
   "source": [
    "# Find Median of Birth year"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b0b38132",
   "metadata": {},
   "outputs": [],
   "source": [
    "column_median = citibike_df['birth_year'].median()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "4b02e3be",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Median of the column 1978.0\n"
     ]
    }
   ],
   "source": [
    "print(\"Median of the column\",column_median)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c09afcfc",
   "metadata": {},
   "source": [
    "# Replace missing values in Birth Year column with median value (1978)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d81229e3",
   "metadata": {},
   "outputs": [],
   "source": [
    "citibike_df['birth_year'].fillna(1978, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "f1ce67a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>trip_id</th>\n",
       "      <th>bike_id</th>\n",
       "      <th>weekday</th>\n",
       "      <th>start_hour</th>\n",
       "      <th>start_time</th>\n",
       "      <th>start_station_id</th>\n",
       "      <th>start_station_name</th>\n",
       "      <th>start_station_latitude</th>\n",
       "      <th>start_station_longitude</th>\n",
       "      <th>end_time</th>\n",
       "      <th>end_station_id</th>\n",
       "      <th>end_station_name</th>\n",
       "      <th>end_station_latitude</th>\n",
       "      <th>end_station_longitude</th>\n",
       "      <th>trip_duration</th>\n",
       "      <th>subscriber</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>gender</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>LnQzQk</td>\n",
       "      <td>16013</td>\n",
       "      <td>Mon</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-09-09 18:18:55</td>\n",
       "      <td>523</td>\n",
       "      <td>W 38 St &amp; 8 Ave</td>\n",
       "      <td>40.754666</td>\n",
       "      <td>-73.991382</td>\n",
       "      <td>2013-09-09 18:35:28</td>\n",
       "      <td>334</td>\n",
       "      <td>W 20 St &amp; 7 Ave</td>\n",
       "      <td>40.742388</td>\n",
       "      <td>-73.997262</td>\n",
       "      <td>993</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1968.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>IL9boN</td>\n",
       "      <td>15230</td>\n",
       "      <td>Thu</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-09-12 18:38:53</td>\n",
       "      <td>257</td>\n",
       "      <td>Lispenard St &amp; Broadway</td>\n",
       "      <td>40.719392</td>\n",
       "      <td>-74.002472</td>\n",
       "      <td>2013-09-12 18:48:34</td>\n",
       "      <td>236</td>\n",
       "      <td>St Marks Pl &amp; 2 Ave</td>\n",
       "      <td>40.728419</td>\n",
       "      <td>-73.987140</td>\n",
       "      <td>581</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1983.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>46clGB</td>\n",
       "      <td>17942</td>\n",
       "      <td>Wed</td>\n",
       "      <td>19</td>\n",
       "      <td>2013-09-18 19:44:04</td>\n",
       "      <td>479</td>\n",
       "      <td>9 Ave &amp; W 45 St</td>\n",
       "      <td>40.760193</td>\n",
       "      <td>-73.991255</td>\n",
       "      <td>2013-09-18 19:50:05</td>\n",
       "      <td>513</td>\n",
       "      <td>W 56 St &amp; 10 Ave</td>\n",
       "      <td>40.768254</td>\n",
       "      <td>-73.988639</td>\n",
       "      <td>361</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1989.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>v7vdFt</td>\n",
       "      <td>19683</td>\n",
       "      <td>Sat</td>\n",
       "      <td>11</td>\n",
       "      <td>2013-09-28 11:54:37</td>\n",
       "      <td>527</td>\n",
       "      <td>E 33 St &amp; 1 Ave</td>\n",
       "      <td>40.743156</td>\n",
       "      <td>-73.974347</td>\n",
       "      <td>2013-09-28 12:03:58</td>\n",
       "      <td>441</td>\n",
       "      <td>E 52 St &amp; 2 Ave</td>\n",
       "      <td>40.756014</td>\n",
       "      <td>-73.967416</td>\n",
       "      <td>561</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1988.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>VGBsb5</td>\n",
       "      <td>18024</td>\n",
       "      <td>Sat</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-09-07 18:08:22</td>\n",
       "      <td>521</td>\n",
       "      <td>8 Ave &amp; W 31 St</td>\n",
       "      <td>40.750450</td>\n",
       "      <td>-73.994811</td>\n",
       "      <td>2013-09-07 18:46:38</td>\n",
       "      <td>476</td>\n",
       "      <td>E 31 St &amp; 3 Ave</td>\n",
       "      <td>40.743943</td>\n",
       "      <td>-73.979661</td>\n",
       "      <td>2296</td>\n",
       "      <td>Non-Subscriber</td>\n",
       "      <td>1978.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>HbKJBz</td>\n",
       "      <td>14581</td>\n",
       "      <td>Fri</td>\n",
       "      <td>22</td>\n",
       "      <td>2013-09-27 22:01:01</td>\n",
       "      <td>293</td>\n",
       "      <td>Lafayette St &amp; E 8 St</td>\n",
       "      <td>40.730287</td>\n",
       "      <td>-73.990765</td>\n",
       "      <td>2013-09-27 22:08:08</td>\n",
       "      <td>432</td>\n",
       "      <td>E 7 St &amp; Avenue A</td>\n",
       "      <td>40.726218</td>\n",
       "      <td>-73.983799</td>\n",
       "      <td>427</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>aOKk3s</td>\n",
       "      <td>15022</td>\n",
       "      <td>Sun</td>\n",
       "      <td>13</td>\n",
       "      <td>2013-09-29 13:13:06</td>\n",
       "      <td>380</td>\n",
       "      <td>W 4 St &amp; 7 Ave S</td>\n",
       "      <td>40.734011</td>\n",
       "      <td>-74.002939</td>\n",
       "      <td>2013-09-29 13:23:45</td>\n",
       "      <td>317</td>\n",
       "      <td>E 6 St &amp; Avenue B</td>\n",
       "      <td>40.724537</td>\n",
       "      <td>-73.981854</td>\n",
       "      <td>639</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1994.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>kpcluW</td>\n",
       "      <td>16253</td>\n",
       "      <td>Sat</td>\n",
       "      <td>10</td>\n",
       "      <td>2013-09-21 10:48:14</td>\n",
       "      <td>346</td>\n",
       "      <td>Bank St &amp; Hudson St</td>\n",
       "      <td>40.736529</td>\n",
       "      <td>-74.006180</td>\n",
       "      <td>2013-09-21 10:52:37</td>\n",
       "      <td>212</td>\n",
       "      <td>W 16 St &amp; The High Line</td>\n",
       "      <td>40.743349</td>\n",
       "      <td>-74.006818</td>\n",
       "      <td>263</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1969.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>GC8mJC</td>\n",
       "      <td>16745</td>\n",
       "      <td>Fri</td>\n",
       "      <td>12</td>\n",
       "      <td>2013-09-20 12:29:49</td>\n",
       "      <td>510</td>\n",
       "      <td>W 51 St &amp; 6 Ave</td>\n",
       "      <td>40.760660</td>\n",
       "      <td>-73.980420</td>\n",
       "      <td>2013-09-20 12:40:55</td>\n",
       "      <td>422</td>\n",
       "      <td>W 59 St &amp; 10 Ave</td>\n",
       "      <td>40.770513</td>\n",
       "      <td>-73.988038</td>\n",
       "      <td>666</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>qyXq7X</td>\n",
       "      <td>19556</td>\n",
       "      <td>Tue</td>\n",
       "      <td>16</td>\n",
       "      <td>2013-09-03 16:56:06</td>\n",
       "      <td>446</td>\n",
       "      <td>W 24 St &amp; 7 Ave</td>\n",
       "      <td>40.744876</td>\n",
       "      <td>-73.995299</td>\n",
       "      <td>2013-09-03 17:05:48</td>\n",
       "      <td>342</td>\n",
       "      <td>Columbia St &amp; Rivington St</td>\n",
       "      <td>40.717400</td>\n",
       "      <td>-73.980166</td>\n",
       "      <td>582</td>\n",
       "      <td>Subscriber</td>\n",
       "      <td>1983.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  trip_id  bike_id weekday  start_hour           start_time  start_station_id  \\\n",
       "0  LnQzQk    16013     Mon          18  2013-09-09 18:18:55               523   \n",
       "1  IL9boN    15230     Thu          18  2013-09-12 18:38:53               257   \n",
       "2  46clGB    17942     Wed          19  2013-09-18 19:44:04               479   \n",
       "3  v7vdFt    19683     Sat          11  2013-09-28 11:54:37               527   \n",
       "4  VGBsb5    18024     Sat          18  2013-09-07 18:08:22               521   \n",
       "5  HbKJBz    14581     Fri          22  2013-09-27 22:01:01               293   \n",
       "6  aOKk3s    15022     Sun          13  2013-09-29 13:13:06               380   \n",
       "7  kpcluW    16253     Sat          10  2013-09-21 10:48:14               346   \n",
       "8  GC8mJC    16745     Fri          12  2013-09-20 12:29:49               510   \n",
       "9  qyXq7X    19556     Tue          16  2013-09-03 16:56:06               446   \n",
       "\n",
       "        start_station_name  start_station_latitude  start_station_longitude  \\\n",
       "0          W 38 St & 8 Ave               40.754666               -73.991382   \n",
       "1  Lispenard St & Broadway               40.719392               -74.002472   \n",
       "2          9 Ave & W 45 St               40.760193               -73.991255   \n",
       "3          E 33 St & 1 Ave               40.743156               -73.974347   \n",
       "4          8 Ave & W 31 St               40.750450               -73.994811   \n",
       "5    Lafayette St & E 8 St               40.730287               -73.990765   \n",
       "6         W 4 St & 7 Ave S               40.734011               -74.002939   \n",
       "7      Bank St & Hudson St               40.736529               -74.006180   \n",
       "8          W 51 St & 6 Ave               40.760660               -73.980420   \n",
       "9          W 24 St & 7 Ave               40.744876               -73.995299   \n",
       "\n",
       "              end_time  end_station_id            end_station_name  \\\n",
       "0  2013-09-09 18:35:28             334             W 20 St & 7 Ave   \n",
       "1  2013-09-12 18:48:34             236         St Marks Pl & 2 Ave   \n",
       "2  2013-09-18 19:50:05             513            W 56 St & 10 Ave   \n",
       "3  2013-09-28 12:03:58             441             E 52 St & 2 Ave   \n",
       "4  2013-09-07 18:46:38             476             E 31 St & 3 Ave   \n",
       "5  2013-09-27 22:08:08             432           E 7 St & Avenue A   \n",
       "6  2013-09-29 13:23:45             317           E 6 St & Avenue B   \n",
       "7  2013-09-21 10:52:37             212     W 16 St & The High Line   \n",
       "8  2013-09-20 12:40:55             422            W 59 St & 10 Ave   \n",
       "9  2013-09-03 17:05:48             342  Columbia St & Rivington St   \n",
       "\n",
       "   end_station_latitude  end_station_longitude  trip_duration      subscriber  \\\n",
       "0             40.742388             -73.997262            993      Subscriber   \n",
       "1             40.728419             -73.987140            581      Subscriber   \n",
       "2             40.768254             -73.988639            361      Subscriber   \n",
       "3             40.756014             -73.967416            561      Subscriber   \n",
       "4             40.743943             -73.979661           2296  Non-Subscriber   \n",
       "5             40.726218             -73.983799            427      Subscriber   \n",
       "6             40.724537             -73.981854            639      Subscriber   \n",
       "7             40.743349             -74.006818            263      Subscriber   \n",
       "8             40.770513             -73.988038            666      Subscriber   \n",
       "9             40.717400             -73.980166            582      Subscriber   \n",
       "\n",
       "   birth_year  gender  \n",
       "0      1968.0       2  \n",
       "1      1983.0       1  \n",
       "2      1989.0       1  \n",
       "3      1988.0       2  \n",
       "4      1978.0       0  \n",
       "5      1986.0       2  \n",
       "6      1994.0       1  \n",
       "7      1969.0       1  \n",
       "8      1993.0       1  \n",
       "9      1983.0       1  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "citibike_df.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "e60a67ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "missing_values = citibike_df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "28f72b50",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing values in citibike_df:\n"
     ]
    }
   ],
   "source": [
    "print(\"Missing values in citibike_df:\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "bb6a1166",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "trip_id                    0\n",
      "bike_id                    0\n",
      "weekday                    0\n",
      "start_hour                 0\n",
      "start_time                 0\n",
      "start_station_id           0\n",
      "start_station_name         0\n",
      "start_station_latitude     0\n",
      "start_station_longitude    0\n",
      "end_time                   0\n",
      "end_station_id             0\n",
      "end_station_name           0\n",
      "end_station_latitude       0\n",
      "end_station_longitude      0\n",
      "trip_duration              0\n",
      "subscriber                 0\n",
      "birth_year                 0\n",
      "gender                     0\n",
      "dtype: int64\n"
     ]
    }
   ],
   "source": [
    "print(missing_values)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1074f74",
   "metadata": {},
   "source": [
    "# No missing values"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "65c5aec1",
   "metadata": {},
   "source": [
    "# Checking For duplicate values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "788c32f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "duplicate_rows = citibike_df.duplicated()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "109ab5d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "num_duplicates = duplicate_rows.sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "99c3d512",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "There are no duplicate rows in the citibike_df DataFrame.\n"
     ]
    }
   ],
   "source": [
    "if num_duplicates > 0:\n",
    "    print(\"There are {} duplicate rows in the citibike_df DataFrame.\".format(num_duplicates))\n",
    "else:\n",
    "    print(\"There are no duplicate rows in the citibike_df DataFrame.\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "57824699",
   "metadata": {},
   "source": [
    "# No Duplicates"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "66a69b70",
   "metadata": {},
   "source": [
    "# Check correct Data Types"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "bfbb8b79",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_types = citibike_df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "eb2d979a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Data types in citibike_df:\n"
     ]
    }
   ],
   "source": [
    "print(\"Data types in citibike_df:\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "48205191",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "trip_id                     object\n",
      "bike_id                      int64\n",
      "weekday                     object\n",
      "start_hour                   int64\n",
      "start_time                  object\n",
      "start_station_id             int64\n",
      "start_station_name          object\n",
      "start_station_latitude     float64\n",
      "start_station_longitude    float64\n",
      "end_time                    object\n",
      "end_station_id               int64\n",
      "end_station_name            object\n",
      "end_station_latitude       float64\n",
      "end_station_longitude      float64\n",
      "trip_duration                int64\n",
      "subscriber                  object\n",
      "birth_year                 float64\n",
      "gender                       int64\n",
      "dtype: object\n"
     ]
    }
   ],
   "source": [
    "print(data_types)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "649cc731",
   "metadata": {},
   "source": [
    "# Data Types are correct"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cedeee51",
   "metadata": {},
   "source": [
    "# Save cleaned data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "6e160099",
   "metadata": {},
   "outputs": [],
   "source": [
    "citibike_df.to_csv(os.path.join(path, '02 Data','Prepared Data', 'cleaned_citibike_df.csv'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f0db3d9b",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
